\documentclass{beamer}

\input{commands.tex}

\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}

\usepackage{graphicx}
\graphicspath{{figs/}{../figs/}}

\usepackage{amsmath, amssymb, mathtools}

\hypersetup{
	colorlinks,
	linkcolor = {red!50!blue},
	citecolor = {red!50!blue},
	urlcolor = {red!50!blue},
	linktoc = page
}

\title{}
\author{Arnau Mas}
\date{September 3rd 2020}


\begin{document}
\frame{\titlepage}

\section{The problem}

\begin{frame}
	\frametitle{What is radiomics?}
	\begin{itemize}
		\item Has its origins in the field of oncology: tumour imaging \pause
		\item Extract many \alert{radiomic features} from scans \pause
		\item Look for correlations between radiomic features and treatment response
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{What is radiomics?}
	\begin{columns}
		\begin{column}{0.5\textwidth}
			\begin{block}{Benefits}
				\begin{itemize}
					\item Non-invasive
					\item More systematic
					\item Quantitative
				\end{itemize} \pause
			\end{block}		
		\end{column}
		
		\begin{column}{0.5\textwidth}
			\begin{block}{Drawbacks}
				\begin{itemize}
					\item May be hard to reproduce
					\item High dimensional feature spaces
					\item Limited number of cases
				\end{itemize} 
			\end{block}				
		\end{column}
	\end{columns}
\end{frame}

\begin{frame}
	\frametitle{TOPiomics}

	\begin{center}
		\includegraphics[width = 3cm]{beamer/logo-cvc}
		\hfill
		\includegraphics[width = 3cm]{beamer/logo-vhio}
	\end{center}

	\begin{itemize}
		\item TOPiomics is an ongoing collaboration between the Computer Vision Center (CVC) and the
			Vall d'Hebron Institute of Oncology (VHIO). \pause

		\item Main aim: early detection of patients with strange radiomic signatures,
			\emph{outliers}, for whom standard treatments could fail. \pause

		\item	Use \emph{topological data analysis}, hence TOPiomics (topological radiomics).

	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{Prior work}
	\begin{itemize}
		\item Progress thus far: use the \emph{mutual \( k \)-nearest neighbours} (\MKNN) graph to
			detect outliers. \pause
		\item Problem: there is a parameter that has to be fixed. It has to do with the scale
			at which we look at the data. \pause
		\item Idea: look at \emph{every} parameter value. \pause 
	\end{itemize}
	\centering \alert{This is persistence} 
\end{frame}

\section{An overview of homology}
\begin{frame}
	\frametitle{The elevator pitch}
	Algebraic topology studies topological spaces by computing algebraic invariants, namely
	with functors
	\begin{gather*}
		\Top \to \Grp \\ 
		\Top \to \Ab \\
		\Top \to \Ring \\
		\Top \to \Vect_K \\
				 \vdots
	\end{gather*}
	\pause
	Homology groups are one of these functors,
	\begin{equation*}
		H_n \colon \Top \to \Ab. 
	\end{equation*}
	\pause
	They come in many flavours, the simplest one is \emph{simplicial homology}, which works
	for \emph{simplicial complexes}. 
\end{frame}

\begin{frame}
	\frametitle{The ingredients of homology}
	\begin{columns}
		\begin{column}{0.5\textwidth}
			\begin{itemize}
				\item<1-> \emph{Simplex}. The convex hull of \alt<3->{an (ordered)}{a} set of
					\only<2->{(geometrically independent)} points. 
				\item<4-> \emph{Simplicial complex}, \( K \). Topological space assembled out of
					simplices glued along their faces. 
				\item<5-> \emph{Chain groups}, \( C_n(K) \). Free abelian groups generated by the \( n
					\)-simplices of a complex. 
			\end{itemize}		
		\end{column}

		\begin{column}{0.5\textwidth}
			\begin{center}
				\only<1-3>{\includegraphics[scale=0.3]{beamer/simplices}}	
				\includegraphics<4->[scale=0.1]{beamer/complex}	
			\end{center}
		\end{column}
	\end{columns}
	
	\uncover<5>{
		\begin{block}{Remark}
			In the combinatorial picture, the geometrical requirements are dropped and one speaks
			of \emph{abstract} simplices, \emph{abstract} simplicial complexes, etc.
		\end{block}
	}
\end{frame}

\begin{frame}
	\frametitle{The boundary morphism}
	\begin{block}{Orientation}
		The simplex generated by \( p_0, \dots, p_n \) is written \( [p_0, \dots, p_n] \). The
		ordering determines an orientation, and we require that flipping orientation implies a
		change of sign in \( C_n(K) \), e.g.
		\begin{equation*}
			[p_0, p_1, \dots, p_n] = -[p_1, p_0, \dots, p_n]. 
		\end{equation*}
		\pause
		The chain groups are not really free!
	\end{block}
\end{frame}

\begin{frame}
	\frametitle{The boundary morphisms}
	Define the boundary morphism \( \partial_n \colon C_n(K) \to C_{n-1}(K) \) by
	\begin{equation*}
		\partial_n [p_0, \dots, p_n] \defeq \sum_{k = 0}^{n} (-1)^k [p_0, \dots, \hat p_k,
		\dots, p_n]
	\end{equation*}
	and extending to chains. 
	\pause

	\centering{\includegraphics[width=0.7\textwidth]{drawings/boundary}}
\end{frame}	

\begin{frame}
	\frametitle{Boundaries and cycles}
	\begin{itemize}
		\item \emph{Cycles:} chains with no boundary,
			\begin{equation*}
				Z_n(K) \defeq \ker{\partial_n} \subseteq C_n(K)
			\end{equation*}
			\pause

		\item \emph{Boundaries:} chains which are the boundary of a higher-dimensional chain,
			\begin{equation*}
				B_n(K) \defeq \im{\partial_{n+1}} \subseteq C_n(K)
			\end{equation*}
		\pause

		\begin{block}{Fact}
			\begin{equation*}
				\partial_n \circ \partial_{n+1} = 0
			\end{equation*}
			so boundaries are always cycles. 
		\end{block}
			
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{Homology groups}
	Homology groups are the quotients
	\begin{equation*}
		H_n(K) \defeq Z_n(K)/B_n(K).
	\end{equation*}
	\pause
	
	The key insight: Homology groups measure \alert{cycles which are not boundaries.} \pause
	They tell us about the number of \( n \)-dimensional holes in our space. 
\end{frame}

\begin{frame}
	\frametitle{What is persistence?}
	Instead of a single simplicial complex, consider a \emph{filtration},
	\begin{equation*}
		K^0 \subseteq K^1 \subseteq \cdots \subseteq K^N.
	\end{equation*}
	\pause
	Then look at this evolution at the level of homology
	\only<1>{
		\begin{equation*}
			H_d^0(K) \into H_d^1(K) \into \cdots \into H_d^N(K)
		\end{equation*}
	}
	\only<2>{
		\begin{equation*}
			H_{\textcolor{red}{d}}^0(K)
			\into H_{\textcolor{red}{d}}^1(K) 
			\into \cdots 
			\into H_{\textcolor{red}{d}}^N(K) 
		\end{equation*}
	}
	\only<3>{
		\begin{equation*}
			H_d^{\textcolor{red}{0}}(K)
			\into H_d^{\textcolor{red}{1}}(K) 
			\into \cdots 
			\into H_d^{\textcolor{red}{N}}(K) 
		\end{equation*}
	}

	\uncover<3>{The steps of the filtration can be thought of as time}
\end{frame}

\begin{frame}
	\frametitle{What is persistence?}
	Because of functoriality, there are maps between the different steps of homology,
	\begin{equation*}
		f_i^j \colon H_d^i(K) \to H_d^j(K).
	\end{equation*}
	\pause
	At each step, classes can be born (not in the image of \( f_i^{i+1} \)), die (in the
	kernel of \( f_i^{i+1} \)) or merge (have the same image through \( f_i^{i+1} \)).
\end{frame}

\begin{frame}
	\frametitle{An example}
	\centering
	\only<1>{\includegraphics[width=\textwidth]{beamer/filt-1}}
	\only<2>{\includegraphics[width=\textwidth]{beamer/filt-2}}
	\only<3>{\includegraphics[width=\textwidth]{beamer/filt-3}}
	\only<4>{\includegraphics[width=\textwidth]{beamer/filt-4}}

	\only<1>{\( [p_0], [p_1], [p_2], [p_3] \) are born.}
	\only<2>{\( [p_0], [p_1], [p_2], [p_3] \) merge.}
	\only<3>{The cycle \( [p_0,p_1] + [p_1,p_2] + [p_2,p_3] + [p_3,p_4] \) is born.}
	\only<4>{The cycle does not die.}
\end{frame}

\section{The detector}
\begin{frame}
	\frametitle{Why the \MKNN graph?}
	It is good for detecting clusters in a data set. 
	\begin{center}
		\includegraphics[width=\textwidth]{drawings/mknn}
	\end{center}
\end{frame}

\begin{frame}
	\frametitle{The outlier detection algorithm}
	The algorithm has four main parts: \pause
	\begin{itemize}
		\item The class \texttt{Cloud} stores a point cloud and computes its \MKNN graph.
			\pause
		\item The class \texttt{Filtration} builds up the filtration. \pause
		\item The class \texttt{Homology} computes the homology. \pause
		\item The persistence data of each class is gathered and plotted to detect the
			outliers. 
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{The class \texttt{Cloud}}
	
\end{frame}

\section{The results}
\begin{frame}
	\frametitle{A run with toy data}
	\centering
	\includegraphics[width=\textwidth]{beamer/clusters}
\end{frame}

\begin{frame}
	\frametitle{A run with toy data}
	\centering
	\includegraphics[width=\textwidth]{beamer/toy-results}
\end{frame}

\end{document}
